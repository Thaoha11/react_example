{"ast":null,"code":"var _jsxFileName = \"C:\\\\Coding\\\\my-app\\\\src\\\\Account\\\\Member\\\\Update.js\";\nimport axios from \"axios\";\nimport React, { Component } from \"react\";\nimport ErrorForm from \"./../../Member/ErrorForm\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nclass Update extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      name: \"\",\n      email: \"\",\n      password: \"\",\n      address: \"\",\n      phone: \"\",\n      avatar: \"\",\n      formError: {},\n      file: \"\",\n      msg: \"\",\n      level: 0\n    };\n    this.handleValue = this.handleValue.bind(this);\n    this.handleSubmit = this.handleSubmit.bind(this);\n    this.handleInputFile = this.handleInputFile.bind(this);\n  }\n\n  handleValue(e) {\n    let nameInput = e.target.name;\n    let value = e.target.value;\n    this.setState({\n      [nameInput]: value\n    }); // console.log(value);\n  }\n\n  componentDidMount() {\n    const getInfo = localStorage.getItem(\"info\");\n\n    if (getInfo) {\n      const convInfo = JSON.parse(getInfo); // console.log(convInfo)\n\n      this.setState({\n        name: convInfo.Auth.name,\n        email: convInfo.Auth.email,\n        address: convInfo.Auth.address,\n        phone: convInfo.Auth.phone\n      });\n    } else {\n      this.props.history.push(\"/login\");\n    }\n  }\n\n  handleSubmit(e) {\n    e.preventDefault();\n    const convInfo = JSON.parse(localStorage.getItem(\"info\"));\n    let flag = true;\n    let {\n      name,\n      file,\n      password,\n      phone,\n      address\n    } = this.state;\n    let errSubmit = this.state.formError;\n\n    if (name == \"\") {\n      flag = false;\n      errSubmit.name = \"Name khong duoc de trong\";\n    } else {\n      flag = true;\n      errSubmit.name = \"\";\n    }\n\n    if (password == \"\") {\n      flag = false;\n      errSubmit.password = \"Password khong duoc de trong\";\n    } else {\n      flag = true;\n      errSubmit.password = \"\";\n    }\n\n    if (phone == \"\") {\n      flag = false;\n      errSubmit.phone = \"Phone khong duoc de trong\";\n    } else {\n      flag = true;\n      errSubmit.phone = \"\";\n    }\n\n    if (address == \"\") {\n      flag = false;\n      errSubmit.address = \"Address khong duoc de trong\";\n    } else {\n      flag = true;\n      errSubmit.address = \"\";\n    }\n\n    if (file == '') {\n      flag = false;\n      errSubmit.file = \"Avatar khong duoc de trong\";\n    } else {\n      if (file.size > 1024 * 1024) {\n        flag = false;\n        errSubmit.file = \"anh tai len qua 1mb \";\n      } else {\n        const typeImg = [\"png\", \"jpg\", \"jpeg\", \"PNG\", \"JPG\"];\n        let res = file.name.split(\".\");\n\n        if (!typeImg.includes(res[1])) {\n          errSubmit.file = \"Vui long nhap dung dinh dang hinh anh\";\n        } else {\n          flag = true;\n          errSubmit.file = \"\";\n        }\n      }\n    }\n\n    if (!flag) {\n      this.setState({\n        formError: errSubmit\n      });\n    } else {\n      const data = {\n        name: this.state.name,\n        email: this.state.email,\n        password: this.state.password,\n        phone: this.state.phone,\n        address: this.state.address,\n        avatar: this.state.avatar\n      };\n      const getIdUser = convInfo.Auth.id;\n      let url = \"http://localhost/laravel/public/api/user/update/\" + getIdUser;\n      const accessToken = convInfo.success.token;\n      let config = {\n        headers: {\n          Authorization: \"Bearer \" + accessToken,\n          \"Content-Type\": \"application/x-www-form-urlencoded\",\n          Accept: \"application/json\"\n        }\n      };\n      const formData = new FormData();\n      formData.append(\"name\", this.state.name);\n      formData.append(\"email\", convInfo.Auth.email);\n      formData.append(\"password\", this.state.password);\n      formData.append(\"phone\", this.state.phone);\n      formData.append(\"address\", this.state.address);\n      formData.append(\"image_user\", this.state.avatar);\n      axios.post(url, formData, config).then(res => {\n        console.log(res);\n\n        if (res.data.errors) {\n          this.setState({\n            formError: res.data.errors\n          });\n        } else {\n          const convert = JSON.stringify(res.data);\n          localStorage.setItem(\"info\", convert);\n          this.setState({\n            name: \"\",\n            email: \"\",\n            pass: \"\",\n            phone: \"\",\n            address: \"\",\n            avatar: \"\",\n            level: 0,\n            msg: \"update thanh cong \"\n          });\n        }\n      });\n    }\n  }\n\n  handleInputFile(e) {\n    const file = e.target.files;\n    let reader = new FileReader();\n\n    reader.onload = e => {\n      this.setState({\n        avatar: e.target.result,\n        //gui qua api\n        file: file[0] // de toan bo he thong file uploadvao file de xuong check validate\n\n      });\n    };\n\n    reader.readAsDataURL(file[0]);\n  }\n\n  render() {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"col-sm-8 col-sm-offset-1\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"login-form\",\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          children: \"User UpDate!\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 179,\n          columnNumber: 11\n        }, this), this.state.msg, /*#__PURE__*/_jsxDEV(ErrorForm, {\n          formError: this.state.formError\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 181,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n          onSubmit: this.handleSubmit,\n          enctype: \"multipart/form-data\",\n          children: [/*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"text\",\n            name: \"name\",\n            value: this.state.name,\n            placeholder: \"Name\",\n            onChange: this.handleValue\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 183,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"text\",\n            name: \"email\",\n            disabled: true,\n            value: this.state.email,\n            placeholder: \"Email Address\",\n            onChange: this.handleValue\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 190,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"text\",\n            name: \"password\",\n            value: this.state.password,\n            placeholder: \"Password\",\n            onChange: this.handleValue\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 198,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"text\",\n            name: \"address\",\n            value: this.state.address,\n            placeholder: \"Address\",\n            onChange: this.handleValue\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 205,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"text\",\n            name: \"phone\",\n            value: this.state.phone,\n            placeholder: \"Phone Number\",\n            onChange: this.handleValue\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 212,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"file\",\n            name: \"avatar\",\n            onChange: this.handleInputFile\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 219,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"submit\",\n            className: \"btn btn-default\",\n            style: {\n              marginBottom: \"20px\"\n            },\n            children: \"Update\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 220,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 182,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 178,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 177,\n      columnNumber: 7\n    }, this);\n  }\n\n}\n\nexport default Update;","map":{"version":3,"sources":["C:/Coding/my-app/src/Account/Member/Update.js"],"names":["axios","React","Component","ErrorForm","Update","constructor","props","state","name","email","password","address","phone","avatar","formError","file","msg","level","handleValue","bind","handleSubmit","handleInputFile","e","nameInput","target","value","setState","componentDidMount","getInfo","localStorage","getItem","convInfo","JSON","parse","Auth","history","push","preventDefault","flag","errSubmit","size","typeImg","res","split","includes","data","getIdUser","id","url","accessToken","success","token","config","headers","Authorization","Accept","formData","FormData","append","post","then","console","log","errors","convert","stringify","setItem","pass","files","reader","FileReader","onload","result","readAsDataURL","render","marginBottom"],"mappings":"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","sourcesContent":["import axios from \"axios\";\r\nimport React, { Component } from \"react\";\r\nimport ErrorForm from \"./../../Member/ErrorForm\";\r\nclass Update extends Component {\r\n    constructor(props) {\r\n      super(props);\r\n      this.state = {\r\n          name: \"\",\r\n          email: \"\",\r\n          password: \"\",\r\n          address: \"\",\r\n          phone: \"\",\r\n          avatar: \"\",\r\n          formError: {},\r\n          file: \"\",\r\n          msg: \"\",\r\n          level : 0\r\n      };\r\n\r\n      this.handleValue = this.handleValue.bind(this);\r\n      this.handleSubmit = this.handleSubmit.bind(this);\r\n      this.handleInputFile = this.handleInputFile.bind(this);\r\n    }\r\n    \r\n  handleValue(e) {\r\n      let nameInput = e.target.name;\r\n      let value = e.target.value;\r\n      this.setState({\r\n        [nameInput]: value,\r\n      });\r\n      // console.log(value);\r\n  }\r\n\r\n  componentDidMount() {\r\n\r\n      const getInfo = localStorage.getItem(\"info\");\r\n      \r\n      if (getInfo) {\r\n        const convInfo = JSON.parse(getInfo);\r\n        // console.log(convInfo)\r\n        this.setState({\r\n          name: convInfo.Auth.name,\r\n          email: convInfo.Auth.email,\r\n          address: convInfo.Auth.address,\r\n          phone: convInfo.Auth.phone,\r\n        });\r\n      } else {\r\n        this.props.history.push(\"/login\");\r\n      }\r\n  }\r\n  handleSubmit(e){\r\n      e.preventDefault();\r\n      const convInfo = JSON.parse(localStorage.getItem(\"info\"));\r\n      let flag = true;\r\n      let { name, file, password, phone, address } = this.state;\r\n      let errSubmit = this.state.formError;\r\n      if (name == \"\") {\r\n        flag = false;\r\n        errSubmit.name = \"Name khong duoc de trong\";\r\n      } else {\r\n        flag = true;\r\n        errSubmit.name = \"\";\r\n      }\r\n      if (password == \"\") {\r\n        flag = false;\r\n        errSubmit.password = \"Password khong duoc de trong\";\r\n      } else {\r\n        flag = true;\r\n        errSubmit.password = \"\";\r\n      }\r\n      if (phone == \"\") {\r\n        flag = false;\r\n        errSubmit.phone = \"Phone khong duoc de trong\";\r\n      } else {\r\n        flag = true;\r\n        errSubmit.phone = \"\";\r\n      }\r\n      if (address == \"\") {\r\n        flag = false;\r\n        errSubmit.address = \"Address khong duoc de trong\";\r\n      } else {\r\n        flag = true;\r\n        errSubmit.address = \"\";\r\n      }\r\n      if(file == ''){\r\n        flag = false;\r\n        errSubmit.file = \"Avatar khong duoc de trong\"\r\n      }\r\n      else{\r\n          if(file.size > 1024*1024){\r\n              flag = false;\r\n              errSubmit.file = \"anh tai len qua 1mb \"\r\n          }\r\n          else {\r\n             const typeImg = [\"png\", \"jpg\", \"jpeg\", \"PNG\", \"JPG\"] ;\r\n             let res = file.name.split(\".\");\r\n             if(!typeImg.includes(res[1])){\r\n                errSubmit.file = \"Vui long nhap dung dinh dang hinh anh\"\r\n             }\r\n             else{\r\n                flag = true;\r\n                errSubmit.file = \"\";\r\n             }\r\n          }\r\n      }\r\n\r\n      if(!flag){\r\n          this.setState({\r\n              formError : errSubmit\r\n          })\r\n      }\r\n      else{\r\n          const data = {\r\n              name: this.state.name,\r\n              email: this.state.email,\r\n              password: this.state.password,\r\n              phone: this.state.phone,\r\n              address: this.state.address,\r\n              avatar: this.state.avatar,\r\n            \r\n          }\r\n          const getIdUser = convInfo.Auth.id;\r\n          let url = \"http://localhost/laravel/public/api/user/update/\" + getIdUser;\r\n          const accessToken = convInfo.success.token;\r\n          let config = {\r\n              headers: {\r\n                  Authorization: \"Bearer \" + accessToken,\r\n                  \"Content-Type\": \"application/x-www-form-urlencoded\",\r\n                  Accept: \"application/json\",\r\n              }\r\n          }\r\n          const formData = new FormData();\r\n          formData.append(\"name\", this.state.name);\r\n          formData.append(\"email\", convInfo.Auth.email);\r\n          formData.append(\"password\", this.state.password);\r\n          formData.append(\"phone\", this.state.phone);\r\n          formData.append(\"address\", this.state.address);\r\n          formData.append(\"image_user\", this.state.avatar);\r\n          axios.post(url, formData, config).then((res) => {\r\n              console.log(res);\r\n              if (res.data.errors) {\r\n                this.setState({\r\n                  formError: res.data.errors,\r\n                });\r\n              } else {\r\n                const convert = JSON.stringify(res.data);\r\n                localStorage.setItem(\"info\", convert);\r\n                this.setState({\r\n                  name: \"\",\r\n                  email: \"\",\r\n                  pass: \"\",\r\n                  phone: \"\",\r\n                  address: \"\",\r\n                  avatar: \"\",\r\n                  level: 0,\r\n                  msg: \"update thanh cong \",\r\n                });\r\n            }\r\n          });\r\n      }\r\n      \r\n  }\r\n\r\n  handleInputFile(e) {\r\n    const file = e.target.files;\r\n    let reader = new FileReader();\r\n    reader.onload = (e) => {\r\n      this.setState({\r\n        avatar: e.target.result, //gui qua api\r\n        file: file[0], // de toan bo he thong file uploadvao file de xuong check validate\r\n      });\r\n    };\r\n    reader.readAsDataURL(file[0]);\r\n  }\r\n  render() {\r\n    return (\r\n      <div className=\"col-sm-8 col-sm-offset-1\">\r\n        <div className=\"login-form\">\r\n          <h2>User UpDate!</h2>\r\n          {this.state.msg}\r\n          <ErrorForm formError={this.state.formError} />\r\n          <form onSubmit={this.handleSubmit} enctype=\"multipart/form-data\">\r\n            <input\r\n              type=\"text\"\r\n              name=\"name\"\r\n              value={this.state.name}\r\n              placeholder=\"Name\"\r\n              onChange={this.handleValue}\r\n            />\r\n            <input\r\n              type=\"text\"\r\n              name=\"email\"\r\n              disabled\r\n              value={this.state.email}\r\n              placeholder=\"Email Address\"\r\n              onChange={this.handleValue}\r\n            />\r\n            <input\r\n              type=\"text\"\r\n              name=\"password\"\r\n              value={this.state.password}\r\n              placeholder=\"Password\"\r\n              onChange={this.handleValue}\r\n            />\r\n            <input\r\n              type=\"text\"\r\n              name=\"address\"\r\n              value={this.state.address}\r\n              placeholder=\"Address\"\r\n              onChange={this.handleValue}\r\n            />\r\n            <input\r\n              type=\"text\"\r\n              name=\"phone\"\r\n              value={this.state.phone}\r\n              placeholder=\"Phone Number\"\r\n              onChange={this.handleValue}\r\n            />\r\n            <input type=\"file\" name=\"avatar\" onChange={this.handleInputFile} />\r\n            <button\r\n              type=\"submit\"\r\n              className=\"btn btn-default\"\r\n              style={{ marginBottom: \"20px\" }}\r\n            >\r\n              Update\r\n            </button>\r\n          </form>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\nexport default Update;"]},"metadata":{},"sourceType":"module"}