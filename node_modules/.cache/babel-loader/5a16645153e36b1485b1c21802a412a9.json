{"ast":null,"code":"var _jsxFileName = \"C:\\\\Coding\\\\my-app\\\\src\\\\Account\\\\Member\\\\Update.js\";\nimport axios from \"axios\";\nimport React, { Component } from \"react\"; // import axios from \"axios\";\n\nimport FormErrors from \"../Member/ErrorForm\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nclass Update extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      name: \"\",\n      email: \"\",\n      password: \"\",\n      address: \"\",\n      phone: \"\",\n      avatar: \"\",\n      formError: {},\n      file: \"\",\n      msg: \"\"\n    };\n    this.handleValue = this.handleValue.bind(this);\n    this.handleSubmit = this.handleSubmit.bind(this);\n    this.handleInputFile = this.handleInputFile.bind(this);\n  }\n\n  handleValue(e) {\n    let nameInput = e.target.name;\n    let value = e.target.value;\n    this.setState({\n      [nameInput]: value\n    }); //console.log(value);\n  }\n\n  componentDidMount() {\n    const getInfo = localStorage.getItem(\"infoCus\"); // console.log(getInfo.Auth.name);\n\n    if (getInfo) {\n      const convInfo = JSON.parse(getInfo);\n      this.setState({\n        name: convInfo.Auth.name,\n        email: convInfo.Auth.email,\n        address: convInfo.Auth.address,\n        phone: convInfo.Auth.phone\n      });\n    } else {\n      this.props.history.push(\"/login\");\n    }\n  }\n\n  handleSubmit(e) {\n    //ngan chan su kien mac dinh\n    e.preventDefault();\n    const convInfo = JSON.parse(localStorage.getItem(\"infoCus\"));\n    let flag = true;\n    let {\n      name,\n      file,\n      password,\n      phone,\n      address\n    } = this.state;\n    let errSubmit = this.state.formErrors;\n    const testEmai = /^[A-Z0-9._%+-]+@([A-Z0-9-]+\\.)+[A-Z]{2,4}$/i;\n    const testPasss = /^[a-zA-Z0-9]+$/; //name\n\n    if (name == \"\") {\n      flag = false;\n      errSubmit.name = \"Name khong duoc de trong\";\n    } else {\n      flag = true;\n      errSubmit.name = \"\";\n    } // //email\n    // if (email === \"\") {\n    //   flag = false;\n    //   errSubmit.email = \"Vui long nhap Email\";\n    // } else {\n    //   if (!testEmai.test(email)) {\n    //     flag = false;\n    //     errSubmit.email = \"Email khong hop le\";\n    //   } else {\n    //     flag = true;\n    //     errSubmit.email = \"\";\n    //   }\n    // }\n    //pass\n\n\n    if (password === \"\") {\n      flag = false;\n      errSubmit.password = \"Vui long nhap Password\";\n    } else {\n      if (password.toString().length < 8 && !testPasss.test(password)) {\n        flag = false;\n        errSubmit.password = \"nhap it nhat 8 ky tu bao gom ca chu va so!\";\n      } else {\n        flag = true;\n        errSubmit.password = \"\";\n      }\n    } //phone\n\n\n    if (phone === \"\") {\n      flag = false;\n      errSubmit.phone = \"Vui long nhap so dien thoai\";\n    } else {\n      flag = true;\n      errSubmit.phone = \"\";\n    } //address\n\n\n    if (address === \"\") {\n      flag = false;\n      errSubmit.address = \"Vui long nhap dia chi\";\n    } else {\n      flag = true;\n      errSubmit.address = \"\";\n    } //avatar\n\n\n    if (file) {\n      if (file.size > 1024 * 1024) {\n        flag = false;\n        errSubmit.file = \"anh tai len qua 1mb\";\n      } else {\n        const typeImg = [\"png\", \"jpg\", \"jpeg\", \"PNG\", \"JPG\"];\n        let res = file.name.split(\".\");\n\n        if (!typeImg.includes(res[1])) {\n          errSubmit.file = \"vui long nhap dung dinh dang hinh anh\";\n        } else {\n          flag = true;\n          errSubmit.file = \"\";\n        }\n      }\n    }\n\n    if (!flag) {\n      this.setState({\n        formError: errSubmit\n      });\n    } else {\n      const data = {\n        name: this.state.name,\n        email: this.state.email,\n        password: this.state.password,\n        phone: this.state.phone,\n        address: this.state.address,\n        avatar: this.state.avatar,\n        level: 0\n      };\n      const getIdUser = convInfo.Auth.id;\n      let url = \"http://localhost/laravel/public/api/user/update/\" + getIdUser; // console.log(convInfo);\n\n      const accessToken = convInfo.success.token;\n      let config = {\n        headers: {\n          Authorization: \"Bearer \" + accessToken,\n          \"Content-Type\": \"application/x-www-form-urlencoded\",\n          Accept: \"application/json\"\n        }\n      };\n      const formData = new FormData();\n      formData.append(\"name\", this.state.name);\n      formData.append(\"email\", convInfo.Auth.email);\n      formData.append(\"password\", this.state.password);\n      formData.append(\"phone\", this.state.phone);\n      formData.append(\"address\", this.state.address);\n      formData.append(\"image_user\", this.state.avatar);\n      axios.post(url, formData, config).then(res => {\n        console.log(res);\n\n        if (res.data.errors) {\n          this.setState({\n            formErrors: res.data.errors\n          });\n        } else {\n          const convert = JSON.stringify(res.data);\n          localStorage.setItem(\"infoCus\", convert);\n          this.setState({\n            name: \"\",\n            email: \"\",\n            pass: \"\",\n            phone: \"\",\n            address: \"\",\n            avatar: \"\",\n            level: 0,\n            msg: \"update thanh cong \"\n          });\n        }\n      });\n    }\n  }\n\n  handleInputFile(e) {\n    const file = e.target.files;\n    let reader = new FileReader();\n\n    reader.onload = e => {\n      this.setState({\n        avatar: e.target.result,\n        //gui qua api\n        file: file[0] // de toan bo he thong file uploadvao file de xuong check validate\n\n      });\n    };\n\n    reader.readAsDataURL(file[0]);\n  }\n\n  render() {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"col-sm-8 col-sm-offset-1\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"login-form\",\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          children: \"User UpDate!\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 203,\n          columnNumber: 11\n        }, this), this.state.msg, /*#__PURE__*/_jsxDEV(ErrorForm, {\n          formError: this.state.formError\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 205,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n          onSubmit: this.handleSubmit,\n          enctype: \"multipart/form-data\",\n          children: [/*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"text\",\n            name: \"name\",\n            value: this.state.name,\n            placeholder: \"Name\",\n            onChange: this.handleValue\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 207,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"text\",\n            name: \"email\",\n            disabled: true,\n            value: this.state.email,\n            placeholder: \"Email Address\",\n            onChange: this.handleValue\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 214,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"password\",\n            name: \"password\",\n            value: this.state.password,\n            onChange: this.handleValue\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 222,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"text\",\n            name: \"address\",\n            value: this.state.address,\n            placeholder: \"Address\",\n            onChange: this.handleValue\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 228,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"text\",\n            name: \"phone\",\n            value: this.state.phone,\n            placeholder: \"Phone Number\",\n            onChange: this.handleValue\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 235,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"file\",\n            name: \"avatar\",\n            onChange: this.handleInputFile\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 242,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"submit\",\n            className: \"btn btn-default\",\n            style: {\n              marginBottom: \"20px\"\n            },\n            children: \"Update\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 243,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 206,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 202,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 201,\n      columnNumber: 7\n    }, this);\n  }\n\n}\n\nexport default Update;","map":{"version":3,"sources":["C:/Coding/my-app/src/Account/Member/Update.js"],"names":["axios","React","Component","FormErrors","Update","constructor","props","state","name","email","password","address","phone","avatar","formError","file","msg","handleValue","bind","handleSubmit","handleInputFile","e","nameInput","target","value","setState","componentDidMount","getInfo","localStorage","getItem","convInfo","JSON","parse","Auth","history","push","preventDefault","flag","errSubmit","formErrors","testEmai","testPasss","toString","length","test","size","typeImg","res","split","includes","data","level","getIdUser","id","url","accessToken","success","token","config","headers","Authorization","Accept","formData","FormData","append","post","then","console","log","errors","convert","stringify","setItem","pass","files","reader","FileReader","onload","result","readAsDataURL","render","marginBottom"],"mappings":"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","sourcesContent":["import axios from \"axios\";\r\nimport React, { Component } from \"react\";\r\n// import axios from \"axios\";\r\nimport FormErrors from \"../Member/ErrorForm\";\r\n\r\nclass Update extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      name: \"\",\r\n      email: \"\",\r\n      password: \"\",\r\n      address: \"\",\r\n      phone: \"\",\r\n      avatar: \"\",\r\n      formError: {},\r\n      file: \"\",\r\n      msg: \"\",\r\n    };\r\n\r\n    this.handleValue = this.handleValue.bind(this);\r\n    this.handleSubmit = this.handleSubmit.bind(this);\r\n    this.handleInputFile = this.handleInputFile.bind(this);\r\n  }\r\n\r\n  handleValue(e) {\r\n    let nameInput = e.target.name;\r\n    let value = e.target.value;\r\n    this.setState({\r\n      [nameInput]: value,\r\n    });\r\n    //console.log(value);\r\n  }\r\n  componentDidMount() {\r\n    const getInfo = localStorage.getItem(\"infoCus\");\r\n    // console.log(getInfo.Auth.name);\r\n    if (getInfo) {\r\n      const convInfo = JSON.parse(getInfo);\r\n      this.setState({\r\n        name: convInfo.Auth.name,\r\n        email: convInfo.Auth.email,\r\n        address: convInfo.Auth.address,\r\n        phone: convInfo.Auth.phone,\r\n      });\r\n    } else {\r\n      this.props.history.push(\"/login\");\r\n    }\r\n  }\r\n  handleSubmit(e) {\r\n    //ngan chan su kien mac dinh\r\n\r\n    e.preventDefault();\r\n    const convInfo = JSON.parse(localStorage.getItem(\"infoCus\"));\r\n    let flag = true;\r\n    let { name, file, password, phone, address } = this.state;\r\n\r\n    let errSubmit = this.state.formErrors;\r\n    const testEmai = /^[A-Z0-9._%+-]+@([A-Z0-9-]+\\.)+[A-Z]{2,4}$/i;\r\n    const testPasss = /^[a-zA-Z0-9]+$/;\r\n\r\n    //name\r\n    if (name == \"\") {\r\n      flag = false;\r\n      errSubmit.name = \"Name khong duoc de trong\";\r\n    } else {\r\n      flag = true;\r\n      errSubmit.name = \"\";\r\n    }\r\n    // //email\r\n    // if (email === \"\") {\r\n    //   flag = false;\r\n    //   errSubmit.email = \"Vui long nhap Email\";\r\n    // } else {\r\n    //   if (!testEmai.test(email)) {\r\n    //     flag = false;\r\n    //     errSubmit.email = \"Email khong hop le\";\r\n    //   } else {\r\n    //     flag = true;\r\n    //     errSubmit.email = \"\";\r\n    //   }\r\n    // }\r\n    //pass\r\n    if (password === \"\") {\r\n      flag = false;\r\n      errSubmit.password = \"Vui long nhap Password\";\r\n    } else {\r\n      if (password.toString().length < 8 && !testPasss.test(password)) {\r\n        flag = false;\r\n        errSubmit.password = \"nhap it nhat 8 ky tu bao gom ca chu va so!\";\r\n      } else {\r\n        flag = true;\r\n        errSubmit.password = \"\";\r\n      }\r\n    }\r\n    //phone\r\n    if (phone === \"\") {\r\n      flag = false;\r\n      errSubmit.phone = \"Vui long nhap so dien thoai\";\r\n    } else {\r\n      flag = true;\r\n      errSubmit.phone = \"\";\r\n    }\r\n\r\n    //address\r\n    if (address === \"\") {\r\n      flag = false;\r\n      errSubmit.address = \"Vui long nhap dia chi\";\r\n    } else {\r\n      flag = true;\r\n      errSubmit.address = \"\";\r\n    }\r\n    //avatar\r\n\r\n    if (file) {\r\n      if (file.size > 1024 * 1024) {\r\n        flag = false;\r\n        errSubmit.file = \"anh tai len qua 1mb\";\r\n      } else {\r\n        const typeImg = [\"png\", \"jpg\", \"jpeg\", \"PNG\", \"JPG\"];\r\n        let res = file.name.split(\".\");\r\n\r\n        if (!typeImg.includes(res[1])) {\r\n          errSubmit.file = \"vui long nhap dung dinh dang hinh anh\";\r\n        } else {\r\n          flag = true;\r\n          errSubmit.file = \"\";\r\n        }\r\n      }\r\n    }\r\n\r\n    if (!flag) {\r\n      this.setState({\r\n        formError: errSubmit,\r\n      });\r\n    } else {\r\n      const data = {\r\n        name: this.state.name,\r\n        email: this.state.email,\r\n        password: this.state.password,\r\n        phone: this.state.phone,\r\n        address: this.state.address,\r\n        avatar: this.state.avatar,\r\n        level: 0,\r\n      };\r\n      const getIdUser = convInfo.Auth.id;\r\n      let url = \"http://localhost/laravel/public/api/user/update/\" + getIdUser;\r\n      // console.log(convInfo);\r\n      const accessToken = convInfo.success.token;\r\n      let config = {\r\n        headers: {\r\n          Authorization: \"Bearer \" + accessToken,\r\n          \"Content-Type\": \"application/x-www-form-urlencoded\",\r\n          Accept: \"application/json\",\r\n        },\r\n      };\r\n      const formData = new FormData();\r\n      formData.append(\"name\", this.state.name);\r\n      formData.append(\"email\", convInfo.Auth.email);\r\n      formData.append(\"password\", this.state.password);\r\n      formData.append(\"phone\", this.state.phone);\r\n      formData.append(\"address\", this.state.address);\r\n      formData.append(\"image_user\", this.state.avatar);\r\n\r\n      axios.post(url, formData, config).then((res) => {\r\n        console.log(res);\r\n        if (res.data.errors) {\r\n          this.setState({\r\n            formErrors: res.data.errors,\r\n          });\r\n        } else {\r\n          const convert = JSON.stringify(res.data);\r\n          localStorage.setItem(\"infoCus\", convert);\r\n          this.setState({\r\n            name: \"\",\r\n            email: \"\",\r\n            pass: \"\",\r\n            phone: \"\",\r\n            address: \"\",\r\n            avatar: \"\",\r\n            level: 0,\r\n            msg: \"update thanh cong \",\r\n          });\r\n        }\r\n      });\r\n    }\r\n  }\r\n  handleInputFile(e) {\r\n    const file = e.target.files;\r\n    let reader = new FileReader();\r\n    reader.onload = (e) => {\r\n      this.setState({\r\n        avatar: e.target.result, //gui qua api\r\n        file: file[0], // de toan bo he thong file uploadvao file de xuong check validate\r\n      });\r\n    };\r\n    reader.readAsDataURL(file[0]);\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div className=\"col-sm-8 col-sm-offset-1\">\r\n        <div className=\"login-form\">\r\n          <h2>User UpDate!</h2>\r\n          {this.state.msg}\r\n          <ErrorForm formError={this.state.formError}/>\r\n          <form onSubmit={this.handleSubmit} enctype=\"multipart/form-data\">\r\n            <input\r\n              type=\"text\"\r\n              name=\"name\"\r\n              value={this.state.name}\r\n              placeholder=\"Name\"\r\n              onChange={this.handleValue}\r\n            />\r\n            <input\r\n              type=\"text\"\r\n              name=\"email\"\r\n              disabled\r\n              value={this.state.email}\r\n              placeholder=\"Email Address\"\r\n              onChange={this.handleValue}\r\n            />\r\n            <input\r\n              type=\"password\"\r\n              name=\"password\"\r\n              value={this.state.password}\r\n              onChange={this.handleValue}\r\n            />\r\n            <input\r\n              type=\"text\"\r\n              name=\"address\"\r\n              value={this.state.address}\r\n              placeholder=\"Address\"\r\n              onChange={this.handleValue}\r\n            />\r\n            <input\r\n              type=\"text\"\r\n              name=\"phone\"\r\n              value={this.state.phone}\r\n              placeholder=\"Phone Number\"\r\n              onChange={this.handleValue}\r\n            />\r\n            <input type=\"file\" name=\"avatar\" onChange={this.handleInputFile} />\r\n            <button\r\n              type=\"submit\"\r\n              className=\"btn btn-default\"\r\n              style={{ marginBottom: \"20px\" }}\r\n            >\r\n              Update\r\n            </button>\r\n          </form>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Update;\r\n"]},"metadata":{},"sourceType":"module"}